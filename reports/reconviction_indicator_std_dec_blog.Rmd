---
title: "What's driving Scotland's falling reconviction rate?"
author: "Ben Matthews and Josiah King"
date: "`r format(Sys.time(), '%A %d %B %Y')`"
output: 
  tufte::tufte_html: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,message=FALSE, warning=FALSE)
library(tidyverse)
require(matrixStats)
library(conflicted)
require(combinat)

require(DasGuptR)
#make sure devtools::install_github("josiahpjking/DasGuptR",force=TRUE)
conflict_prefer("filter","dplyr")
conflict_prefer("select","dplyr")
```


Last month Scottish Government released the [Reconviction Rates in Scotland statistical bulletin for the 2016/17 cohort](https://www.gov.scot/publications/reconviction-rates-scotland-2016-17-offender-cohort/). The headline figure in this bulletin is the average number of reconvictions per offender, and 
last month's bulletin shows a steady long-term fall in the reconviction rate in Scotland[^0]. Whilst this is overall fall in the reconviction rate is undoubtedly good news,
in this post we'll show that interpreting this trend is not
as straightforward as it might seem.

[^0]: This coincided with a fall in [police recorded crime and victimization in Scotland too](http://www.research.aqmen.ac.uk/crime-and-victimisation-research-overview/).




# Reconviction rates and baseball batting averages

There are two factors complicating how we understand
this overall decline in the reconviction rate.

First, not all demographic groups have seen this fall in this measure, as we can see from Figure One. For example, the reconviction rate for women
over the age of 30 has increased, despite the overall fall in the reconviction rate. 

```{r plotting}
rdata <- readRDS(here::here("data", "recdata.RDS"))

rdata %>%
  group_by(year, Gender, Age) %>%
  summarise_at(vars(contains("num")), sum) %>%
  mutate(
    rate = (num_reconvicted / num_offenders) * 100,
    sg_freq = num_reconvictions / num_offenders,
    Age = fct_relevel(Age, "under 21")
  ) %>%
  ggplot(., aes(x = year, y = sg_freq, col = Gender)) +
  geom_path() + 
  facet_grid(~Age) +
  ylab("Average number of reconvictions per offender") +
  ggtitle("SG reconviction rate") +
  theme_bw() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  NULL
```

Second, as well as a fall in reconviction rates we've also seen substantial changes over time in number of men and women of different ages convicted (known as the _prevalence_ of conviction)[^1], with very pronounced falls in convictions for young people (and young men in particular) that are not seen in other groups. 

The relationship between these two observations is not very intuitive.
These trends in prevalence of conviction have a knock-on effect on the reconviction rate because they affect the proportions of people of different ages who are convicted in a given year. 
These proportions - the 'offender mix' - can influence the overall reconviction rate _even if the reconviction rates don't change for any age group_.
This is because different age and sex groups typically have different reconviction rates (as we saw in Figure One)[^5]. As the overall reconviction rate the is just average of the conviction rates for each group, _weighted by the size of the group_, 
changes in the proportions of younger to older people and men to women convicted can affect the overall
reconviction rate, without groups' reconviction rates changing at all.
For example, if women over 40, who have a low average reconviction rate, made up a larger proportion of all people convicted then the overall conviction rate would go down, even if the reconviction rate
itself did not change for any age group.
This confusing phenomenon is related to an effect known as Simpson's paradox, and
has been identified in places as diverse as statistics on [kidney-stone removals](https://en.wikipedia.org/wiki/Simpson%27s_paradox#Kidney_stone_treatment)
to [baseball batting averages](https://en.wikipedia.org/wiki/Simpson%27s_paradox#Batting_averages).

[^1]: Ben wrote about these long-term differences in conviction rates in Scotland by age and sex with Jon Minton [here](http://journals.sagepub.com/doi/abs/10.1177/1477370817731706).

[^5]: Typically young people will be convicted at higher rates than older people, and men at higher rates than women.

One implication of this paradox is that the fall in the reconviction rate is not only a measure of changes in reoffending - it also reflects changes in the mix of people coming into the justice system (i.e. being convicted) in the first place.
This also means that we don't know exactly how much of the fall in the overall reconviction rate is due to reductions in reoffending, and much is due to these changes in offender mix, which may reflect things like diversion from prosecution or social changes which mean that fewer people offend.
<!---
Similarly, the proportion of offenders who are reconvicted will also influence the _average number of reconvictions per offender_. 
As an example, imagine that in a given year, there are 100 people convicted, 10 of whom are reconvicted. Each of these 10 is reconvicted 5 times, meaning that this cohort of 100 offenders has between them 50 reconvictions, equating to an average of 0.5 reconvictions per offender. 
In another year, there are again 100 people convicted, 50 of whom are reconvicted, but only once each. This year, again there is an average of 0.5 reconvictions per offender. 
--->

## What can we do about it?

We can work around this issue by using methods developed by demographers to apportion the amount of change in the reconviction rate that is due to actual
reductions in reoffending and how much is due to changes in the mix of people convicted[^3]. Specifically, we use the Prithwith Das Gupta's[^7] specification of two techniques known as _standardization_ and _decomposition_.

[^7]: As set out in his 1993 book _[Standardization and decomposition of rates : a user's manual](https://babel.hathitrust.org/cgi/pt?id=osu.32437011198450)_.

Standardization shows us what the reconviction rate would have been under different scenarios - for example, if there was no change in the proportions of different demographic groups  and only the 'offender mix' changed. Decomposition gives us the percentage of the difference in rates between two years attributable to each of the factors we have included in the standardization.

## Results

```{r DGstuff, include=FALSE}
rdata %>%
  group_by(year, Gender, Age) %>%
  summarise_at(vars(contains("num")), sum) %>%
  left_join(., 
            rdata %>% 
              group_by(year) %>% 
              summarise(total = sum(num_offenders))) %>%
  mutate(
    age_str = num_offenders / total, # this is the age structure of convicted population
    prev = num_reconvicted / num_offenders, # this is the prevalence of reconviction
    freq = num_reconvictions / num_reconvicted
  ) %>% # this is the frequency or reconviction (according to SG)
  ungroup() -> rdata

rdata <- 
rdata %>% 
  mutate(reconvs = prev * freq)

dg_decompose <- 
rdata %>% 
  na.omit() %>% 
  DasGupt_Npop(.,pop=year,reconvs,age_str,id_vars=c(Age,Gender))
```


Applying these methods to Scottish Government's reconvictions data[^6] gives us
the standardized rates in Figure Two. Because both standardized rates are declining we can infer that the changing age-structure has played a role in reducing
the overall reconviction rate. 

[^6]: You can download the data from https://www.gov.scot/publications/reconviction-rates-scotland-2016-17-offender-cohort/


```{r adj_rates}
rdata %>% 
  mutate(rate = reconvs * age_str) %>%
  group_by(year) %>% 
  summarise(
    rate=sum(rate),
    factor="crude"
  ) %>% 
  bind_rows(.,
              dg_decompose %>% 
              group_by(factor) %>%
              summarise_at(vars(starts_with("pop")),sum) %>% 
              gather(year,rate,starts_with("pop")) %>%
              mutate(year=as.numeric(gsub("pop","",year)))
  ) %>%
  mutate(
    rate_type=fct_recode(factor(factor),
                         "Crude"="crude",
                         "adjusted for reconvictions per offender"="age_str",
                         "adjusted for offender mix"="reconvs"
    )
  ) %>%
  ggplot(.,aes(x=year,y=rate,col=rate_type))+
  geom_path()+
  scale_color_manual(values = c("red","black", "blue", "green"))+
  theme_bw()+
  labs(y = "average number of convictions per offender",
       colour = "rate")+
  theme(legend.position="bottom") +
  guides(colour = guide_legend(nrow = 3, byrow = TRUE)) +
  NULL
```


```{r}
pop1=2004
pop2=2016

#ADJUSTED RATES
dg_decompose %>% 
  group_by(factor) %>% 
  summarise(
    !!paste0("rate",pop1):=sum(get(paste0("pop",pop1))),
    !!paste0("rate",pop2):=sum(get(paste0("pop",pop2)))
  ) %>% gather(year,rate,starts_with("rate")) %>% 
  mutate(year=as.numeric(gsub("rate","",year))) -> std_rates

#DG TABLE - CRUDE & DECOMP
rdata %>% mutate(rate=prev*freq*age_str) %>%
            filter(year %in% c(pop1,pop2)) %>%
            group_by(year) %>% summarise(rate=sum(rate)) %>%
            mutate(factor="crude") %>%
  spread(year,rate) %>% 
  mutate(difference=get(paste0(pop1))-get(paste0(pop2))) %>%
  #bind, and diff
  bind_rows(std_rates %>%
              spread(year,rate) %>%
              mutate(difference=get(paste0(pop1))-get(paste0(pop2))),
            .) %>%
  mutate(percent_dist=100*(difference/difference[factor=="crude"])) -> dgtable


```

Just taking the start and end year of the data, decomposition allows us to calculate exactly how much of a role
the changing age-mix has had in reducing the conviction rate: `r round(dgtable$percent_dist[[1]])`% of the change in the _average number of reconvictions per offender_ is attributable to the changing age/sex structure of the convicted population. Scotland's
falling reconviction rate is being driven both by falls in reoffending and by the changing demographic mix of the
convicted population.




```{r results_table}
dgtable %>% mutate(percent_dist=round(percent_dist)) %>% knitr::kable(.,digits=2)
```


[^3]: The code and data used for our analysis is available [here](https://github.com/josiahpjking/DasGuptR).


## So what?
Prior to 2019, while it was still a National Indicator, Scottish Government said that
the reconviction rate ["is one of the main ways of measuring how well we are managing and supporting those that enter our criminal justice system."](https://www2.gov.scot/About/Performance/scotPerforms/indicator/reconviction) 
These results show this description doesn't quite capture the whole story. The reconviction indicator also
picks up on falls in youth conviction, as well as measuring "how well we are managing and supporting those that enter our criminal justice system", it may also be picking up on
changes to youth justice policy in Scotland which have [emphasised diversion from prosecution](http://scottishjusticematters.com/wp-content/uploads/Shrinking-YJ-population-SJM_5-1_April2017-18.pdf).
It may also be picking up on broader social changes[^8] which have led to this shift in the demographic profile of the
convicted population as a result of falling youth conviction.

[^8]: Ben and Jon Minton discussed the different explanations for the crime drop [here](https://journals.sagepub.com/doi/full/10.1177/1477370817731706#_i2).

This post has shown how tricky it can be to measure outcomes in a complicated and interconnected area like criminal justice. To interpret change in the overall reconvictions rate, we need to take
account of difference in convictions patterns across both age and sex (and possibly
other factors, such as socio-economic status[^4]).
The Understanding Inequalities
project aims to understand how inequalities in Scottish society - like those related to age and sex - 
intersect, and how they impact on crime and responses to crime. You can find out more about our work on crime [here](https://www.understanding-inequalities.ac.uk/research-themes/crime).

[^4]: For example, in Sweden researchers have shown that there's a distinct [socio-economic status gradient to the crime drop](http://journals.sagepub.com/doi/full/10.1177/1477370816682979) (NB: This paper is behind a paywall.)
